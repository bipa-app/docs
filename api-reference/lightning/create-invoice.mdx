---
title: "Create Invoice"
description: "Generate a Lightning invoice to receive payments."
api: "POST https://api.bipa.app/v1/lightning/invoices"
---

## Request

Create a Lightning invoice that can be paid by any Lightning wallet.

### Body parameters

<ParamField body="customer_id" type="string" required>
  Customer who will receive the payment
</ParamField>

<ParamField body="amount_sats" type="integer" required>
  Amount in satoshis (1 sat = 0.00000001 BTC)
</ParamField>

<ParamField body="description" type="string">
  Payment description visible to payer (max 639 characters)
</ParamField>

<ParamField body="expiration_seconds" type="integer" default="3600">
  Seconds until invoice expires (max 86400 = 24 hours)
</ParamField>

<ParamField body="metadata" type="object">
  Custom key-value pairs for your reference
</ParamField>

## Response

<ResponseField name="id" type="string">
  Unique invoice identifier
</ResponseField>

<ResponseField name="customer_id" type="string">
  Customer who will receive payment
</ResponseField>

<ResponseField name="payment_request" type="string">
  BOLT11 invoice string (share this with payer)
</ResponseField>

<ResponseField name="payment_hash" type="string">
  Unique payment hash
</ResponseField>

<ResponseField name="amount_sats" type="integer">
  Invoice amount in satoshis
</ResponseField>

<ResponseField name="description" type="string">
  Invoice description
</ResponseField>

<ResponseField name="status" type="string">
  Invoice status: `pending`, `completed`, `expired`
</ResponseField>

<ResponseField name="expires_at" type="string">
  ISO 8601 expiration timestamp
</ResponseField>

<ResponseField name="created_at" type="string">
  ISO 8601 creation timestamp
</ResponseField>

<RequestExample>
```bash cURL
curl -X POST https://api.bipa.app/v1/lightning/invoices \
  -H "Authorization: Bearer sk_live_..." \
  -H "Content-Type: application/json" \
  -d '{
    "customer_id": "cus_a1b2c3d4e5f6",
    "amount_sats": 100000,
    "description": "Coffee payment",
    "expiration_seconds": 3600
  }'
```

```python Python
import requests

response = requests.post(
    "https://api.bipa.app/v1/lightning/invoices",
    headers={
        "Authorization": "Bearer sk_live_...",
        "Content-Type": "application/json"
    },
    json={
        "customer_id": "cus_a1b2c3d4e5f6",
        "amount_sats": 100000,  # 0.001 BTC
        "description": "Coffee payment",
        "expiration_seconds": 3600
    }
)

invoice = response.json()
print(f"Invoice created: {invoice['payment_request']}")
print(f"Amount: {invoice['amount_sats']} sats")
print(f"Expires: {invoice['expires_at']}")
```

```javascript Node.js
const response = await fetch(
  "https://api.bipa.app/v1/lightning/invoices",
  {
    method: "POST",
    headers: {
      "Authorization": "Bearer sk_live_...",
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      customer_id: "cus_a1b2c3d4e5f6",
      amount_sats: 100000, // 0.001 BTC
      description: "Coffee payment",
      expiration_seconds: 3600
    })
  }
);

const invoice = await response.json();
console.log(`Invoice: ${invoice.payment_request}`);
```
</RequestExample>

<ResponseExample>
```json 201 Created
{
  "id": "ln_inv_abc123",
  "customer_id": "cus_a1b2c3d4e5f6",
  "payment_request": "lnbc1m1pjx4q5dpp5v8g7t9k2f4j8n3m6h1d5s9w7k2f4j8n3m6h1d5s9w7k2f4jqqdqqcqzzsxqyz5vqsp5m8n7k6j5h4g3f2d1s0a9q8w7e6r5t4y3u2i1o0p9a8s7d6fq9qyyssq",
  "payment_hash": "a1b2c3d4e5f6789012345678901234567890123456789012345678901234abcd",
  "amount_sats": 100000,
  "description": "Coffee payment",
  "status": "pending",
  "expires_at": "2024-01-15T11:30:00Z",
  "created_at": "2024-01-15T10:30:00Z"
}
```

```json 400 Amount Too Large
{
  "error": {
    "type": "invalid_request_error",
    "code": "amount_too_large",
    "message": "Maximum invoice amount is 10,000,000 satoshis",
    "param": "amount_sats"
  }
}
```
</ResponseExample>

## Displaying the invoice

Generate a QR code from the `payment_request` string:

```javascript
import QRCode from "qrcode";

async function displayInvoice(invoice) {
  // Generate QR code
  const qrDataUrl = await QRCode.toDataURL(invoice.payment_request.toUpperCase());

  // Display to user
  return `
    <div class="lightning-invoice">
      <img src="${qrDataUrl}" alt="Lightning Invoice QR" />
      <p>Amount: ${invoice.amount_sats.toLocaleString()} sats</p>
      <p>Expires: ${new Date(invoice.expires_at).toLocaleString()}</p>
      <input value="${invoice.payment_request}" readonly />
      <button onclick="copyToClipboard('${invoice.payment_request}')">
        Copy Invoice
      </button>
    </div>
  `;
}
```

<Tip>
  Use uppercase for the QR code payload - it produces smaller, more scannable QR codes.
</Tip>

## Handling payment

When the invoice is paid, you'll receive a `lightning.invoice.paid` webhook:

```json
{
  "id": "evt_xyz789",
  "type": "lightning.invoice.paid",
  "data": {
    "object": {
      "id": "ln_inv_abc123",
      "customer_id": "cus_a1b2c3d4e5f6",
      "amount_sats": 100000,
      "status": "completed",
      "payment_preimage": "f6e5d4c3b2a1...",
      "completed_at": "2024-01-15T10:32:00Z"
    }
  }
}
```

The `payment_preimage` serves as cryptographic proof that the payment was made.

